d_current_Ts = 1/8000; %8khz
d_voltage_calib = 5; %3v

d_current_data = [
0.0 
0.0417760
0.2523666
0.9092149
 1.3664197
 1.3295730
 1.3391026
 1.3872070
 1.3721630
 1.3552898
 1.3500037
 1.3353164
 1.3874359
 1.3750347
 1.3843355
 1.3847927
 1.3597619
 1.3546040
 1.3600138
 1.3456817
 1.3633222
 1.3171847
 1.3587330
 1.3695738
 1.3629564
 1.3489903
 1.3636882
 1.3429217
 1.3598307
 1.3429217
 1.3596479
 1.3535793
 1.3269276
 1.3427389
 1.3662652
 1.3655334
 1.3624075
 1.3883278
 1.3730653
 1.3458645
 1.3660820
 1.3535793
 1.3460473
 1.3787678
 1.3785847
 1.3570712
 1.3296872
 1.3620417
 1.3822593
 1.3688420
 1.3601968
 1.3429217
 1.3502710
 1.3359387
 1.3596479
 1.3624075
 1.3567050
 1.3396133
 1.3785847
 1.3853850
 1.3662652
 1.3721506
 1.3660820
 1.3719676
 1.3752763
 1.3721506
 1.3410767
 1.3204933
 1.3554246
 1.3633222
 1.3368533
 1.3522987
 1.3410767
 1.3324472
 1.3662652
 1.3465965
 1.3524817
 1.3372195
 1.3425559
 1.3690250
 1.3407109
 1.3458645
 1.3309680
 1.3421900
 1.3635053
 1.3390643
 1.3442023
 1.2951220
 1.3041332
 1.3557903
 1.3629564
 1.3394302
 1.3407109
 1.3260128
 1.3596479
 1.3374022
 1.3265617
 1.3372195
 1.3489903
 1.3629564
 1.3364876
 1.3537624
 1.3342765
 1.3170017
 1.3559734
 1.3723334
 1.3537624
 1.3329959
 1.3532135
 1.3239848
 1.3394302
 1.3596479
 1.3464133
 1.3526647
 1.3662652
 1.3624075
 1.3603796
 1.3146077
 1.3394302
 1.3504537
 1.3425559
 1.3568881
 1.3364876
 1.3239848
 1.3203103
 1.3432877
 1.3177335
 1.3175506
 1.3271105
 1.3403451
 1.3427389
 1.3633222
 1.3265617
 1.3306020
 1.3394302
 1.3309680
 1.3144250
 1.3269276
 1.3177335
 1.3392472
 1.3278422
 1.3112992
 1.3204933
 1.3432877
 1.3530305
 1.3465965
 1.3366706
 1.3083565
 1.2980647
 1.3103844
 1.3397961
 1.3337277
 1.3309680
 1.3079905
 1.3206763
 1.3146077
 1.3142419
 1.3180995
 1.3078076
 1.3333618
 1.3245337
 1.3142419
 1.3114820
 1.3234360
 1.3335447
 1.3431047
 1.3239848
 1.3238020
 1.3114820
 1.3043160
 1.3208592
 1.3306020
 1.3396133
 1.3309680
 1.3201273
 1.3177335
 1.3017392
 1.2945732
 1.3304190
 1.3147907
 1.3396133
 1.3403451
 1.3460473
 1.3374022
 1.3206763
 1.3368533
 1.3432877
 1.3364876
 1.3434706
 1.3434706
 1.3116650
 1.3044990
 1.3364876
 1.3403451
 1.3309680
 1.3166358
 1.3436535
 1.3243508
 1.3177335
 1.3166358
 1.3495391
 1.3344595
 1.3203103
 1.3306020
 1.3271105
 1.3239848
 1.3208592
 1.3239848
 1.3434706
 1.3146077
 1.3013733
 1.3206763
 1.3267445
 1.3272934
 1.3271105
 1.3431047
 1.3116650
 1.3008244
 1.3204933
 1.3180995
 1.3078076
 1.3177335
 1.3013733
 1.3201273
 1.3431047
 1.3333618
 1.3335447
 1.3179163
 1.3260128
 1.3278422
 1.3112992
 1.3081736
 1.3366706
 1.3177335
 1.3335447
 1.3337277
 1.3399790
 1.3309680
 1.3208592
 1.3114820
 1.3140588
 1.3147907
 1.3015562
 1.3046820
 1.3072588
 1.3309680
 1.3177335
 1.3076247
 1.3304190
 1.3429217
 1.3467792
 1.3050479
 1.3076247
 1.3300533
 1.3272934
 1.3239848
 1.3177335
 1.3044990
 1.3302361
 1.3054137
 1.2949390
 1.3043160
 1.3179163
 1.3112992
 1.3265617
 1.3306020
 1.3241679
 1.3276593
 1.3396133
 1.3368533
 1.3335447
 1.3272934
 1.3177335
 1.3208592
 1.3179163
 1.3079905
 1.3201273
 1.3304190
 1.3109332
 1.3177335
 1.3267445
 1.3333618
 1.3146077
 1.3173675
 1.3397961
 1.3467792
 1.3304190
 1.3179163
 1.3078076
 1.3146077
 1.3081736
 1.3140588
 1.3208592
 1.3272934
 1.3177335
 1.3238020
 1.3271105
 1.3239848
 1.3366706
 1.3366706
 1.3212251
 1.3208592
 1.3147907
 1.3298702
 1.3210422
 1.3177335
 1.3146077
 1.3044990
 1.3114820
 1.3201273
 1.3210422
 1.3333618
 1.3144250
 1.3140588
 1.3462304
 1.3368533
 1.3081736
 1.3204933
 1.3274765
 1.3204933
 1.3370365
 1.3142419
 1.3370365
 1.3272934
 1.3177335
 1.3146077
 1.3173675
 1.3526647
 1.3407109
 1.3304190
 1.3179163
 1.2951220
 1.2881388
 1.3146077
 1.3175506
 1.3271105
 1.3111162
 1.3177335
 1.3204933
 1.3267445
 1.3175506
 1.3046820
 1.3114820
 1.3146077
 1.3074418
 1.3085395
 1.2885048
 1.3197615
 1.3403451
 1.3177335
 1.3144250
 1.3011903
 1.3397961
 1.3497221
 1.3397961
 1.3118480
 1.3041332
 1.3079905
 1.3140588
 1.3146077
 1.3048648
 1.3039502
 1.3372195
 1.3204933
 1.3109332
 1.3083565
 1.3010073
 1.3085395
 1.3199445
 1.3589162
 1.3375853
 1.3208592
 1.3146077
 1.3052308
 1.3008244
 1.3114820
 1.2949390
 1.3015562
 1.2947561
 1.2980647
 1.3177335
 1.3146077
 1.3105673
 1.3179163
 1.3171847
 1.3239848
 1.3306020
 1.3147907
 1.3232531
 1.3464133
 1.3271105
 1.3112992
 1.3206763
 1.3212251
 1.3238020
 1.3241679
 1.3272934
 1.3179163
 1.2984305
 1.3041332
 1.3272934
 1.3432877
 1.3146077
 1.3076247
 1.3175506
 1.3239848
 1.3109332
 1.3111162
 1.3173675
 1.3271105
 1.3309680
 1.3140588
 1.3241679
 1.3144250
 1.3232531
 1.3116650
 1.3201273
 1.3429217
 1.3307849
 1.3013733
 1.3109332
 1.3271105
 1.3274765
 1.3243508
 1.3076247
 1.3083565
 1.3138760
 1.3364876
 1.3311508
 1.3208592
 1.3302361
 1.3306020
 1.3111162
 1.3136930
 1.3048648
 1.3041332
 1.3182823
 1.3204933
 1.3460473
 1.3434706
 1.3243508
 1.3206763
 1.3304190
 1.3212251
 1.3170017
 1.3179163
 1.3208592
 1.2916305
 1.3078076
 1.3243508
 1.3044990
 1.3177335
 1.3144250
 1.3079905
 1.2984305
 1.3044990
 1.3147907
 1.3013733
 1.3011903
 1.3074418
 1.3109332
 1.3052308
 1.2881388
 1.3044990
 1.3295043
 1.3311508
 1.3041332
 1.3052308
 1.3074418
 1.3208592
 1.3146077
 1.3204933
 1.3206763
 1.3243508
 1.3013733
 1.2986135
 1.2881388
 1.3267445
 1.3271105
 1.3180995
 1.3044990
 1.3495391
 1.3217740
 1.3232531
 1.3397961
 1.3340935
 1.3144250
 1.3427389
 1.3184652
 1.3010073
 1.3307849
 1.3177335
 1.3370365
 1.3112992
 1.3072588
 1.3052308
 1.3135101
 1.3403451
 1.3372195
 1.3271105
 1.3239848
 1.3269276
 1.3206763
 1.3081736
 1.3078076
 1.3333618
 1.3304190
 1.3340935
 1.3021050
 1.2976987
 1.3083565
 1.3102014
 1.3431047
 1.3146077
 1.3138760
 1.3302361
 1.3405278
 1.3337277
 1.3210422
 1.3269276
 1.3272934
 1.3335447
 1.3247168
 1.3111162
 1.3140588
 1.3272934
 1.3210422
 1.3170017
 1.3149737
 1.3072588
 1.3239848
 1.3304190
 1.3180995
 1.3147907
 1.2951220
 1.3011903
 1.3204933
 1.3206763
 1.3215910
 1.2851960
 1.2886877
 1.2914474
 1.2885048
 1.2785790
 1.3265617
 1.3180995
 1.2916305
 1.2916305
 1.2982475
 1.3114820
 1.3081736
 1.3107503
 1.3306020
 1.3274765
 1.3177335
 1.3140588
 1.3396133
 1.3403451
 1.3214080
 1.3079905
 1.3206763
 1.3306020
 1.3021050
 1.3008244
 1.3306020
 1.3180995
 1.3052308
 1.2978818
 1.3017392
 1.3072588
 1.3271105
 1.3271105
 1.3368533
 1.3342765
 1.2954878
 1.3010073
 1.3302361
 1.3309680
 1.3149737
 1.3171847
 1.3241679
 1.3239848
 1.3177335
 1.3331790
 1.3399790
 1.3500880
 1.3184652
 1.2914474
 1.3302361
 1.3309680
 1.2953050
 1.3044990
 1.3142419
 1.3368533
 1.3248996
 1.3008244
 1.3081736
 1.3201273
 1.3179163
 1.3239848
 1.3083565
 1.2984305
 1.3013733
 1.3017392
 1.2978818
 1.3272934
 1.3114820
 1.3114820
 1.3050479
 1.3019222
 1.2883218
 1.3111162
 1.3114820
 1.2916305
 1.3302361
 1.3271105
 1.3302361
 1.3146077
 1.3140588
 1.3247168
 1.3171847
 1.3180995
 1.3238020
 1.3152339
 1.3015337
 1.3216724
 1.3052332
 1.3113972
 1.3246860
 1.3245487
 1.3113972
 1.2989319
 1.2887940
 1.3176984
 1.3187963
 1.2924936
 1.2759170
 1.2922192
 1.3115345
 1.3208490
 1.3375628
 1.3244115
 1.3245487
 1.3050959
 1.3145477
 1.3150967
 1.2985203
 1.2959185
 1.3012592
 1.3407135
 1.3344120
 1.3150967
 1.3111227
 1.3152339
 1.2955068
 1.2952324
 1.3049588
 1.3115345
 1.3145477
 1.3305754
 1.3212609
 1.3150967
 1.3083838
 1.3018081
 1.3086584
 1.3112601
 1.3150967
 1.3019453
 1.2987947
 1.3081095
 1.3212609
 1.3023570
 1.3018081
 1.3019453
 1.2918074
 1.3209863
 1.3308498
 1.3246860
 1.3083838
 1.3149595
 1.3212609
 1.3401645
 1.3250976
 1.2790676
 1.3046844
 1.3119461
 1.3045471
 1.3307125
 1.3248231
 1.3149595
 1.3112601
 1.3245487
 1.3213980
 1.3083838
 1.3145477
 1.3112601
 1.3089328
 1.2950952
 1.3276993
 1.3052332
 1.3049588
 1.3338632
 1.3089328
 1.3044098
 1.3471520
 1.3087957
 1.2950952
 1.3085211
 1.2922192
 1.2920818
 1.2892057
 1.2822182
 1.2986574
 1.3020825
 1.2889312
 1.3046844
 1.3118089
 1.3081095
 1.3244115
 1.3182474
 1.3113972
 1.3118089
 1.3012592
 1.3279737
 1.3112601
 1.3186592
 1.2824926
 1.2982458
 1.3183846
 1.3079723
 1.3179728
 1.3055076
 1.3176984
 1.3241368
 1.3185218
 1.3046844
 1.3085211
 1.3203002
 1.3283854
 1.2859177
 1.2886567
 1.3050959
 1.3146850
 1.2926306
 1.2919445
 1.3016709
 1.3179728
 1.3308498
 1.3086584
 1.3242742
 1.3216724
 1.3086584
 1.3109855

    ]

% valid_d_current_data = valid_d_current_data(1:length(d_current_data))



d_voltage_input_array = [];
d_current_time_array = [];
for i=1:length(d_current_data)
    d_current_time_array(i) = (i-1)*d_current_Ts;
    d_voltage_input_array(i) = d_voltage_calib;
end
d_voltage_input_array(1) = 0;
d_current_time_array = d_current_time_array';
d_voltage_input_array = d_voltage_input_array';
f6 = figure;
plot(d_current_time_array, d_current_data, 'b')
title('current on d-axis');
xlabel('sampling time (s)') ;
ylabel('current on d-axis (A)') ;
axis([0 d_current_time_array(end)  0 inf])
grid on